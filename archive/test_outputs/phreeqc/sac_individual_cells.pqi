
TITLE Corrected SAC with Individual Cell Exchange

EXCHANGE_SPECIES
    Na+ + X- = NaX
        log_k  0.0
    Ca+2 + 2X- = CaX2
        log_k  1.6
    Mg+2 + 2X- = MgX2
        log_k  1.3

SOLUTION 0  # Feed
    units     mg/L
    temp      25.0
    pH        7.5
    Ca        180
    Mg        80
    Na        50
    Cl        400 charge

SOLUTION 1-20  # Initial
    units     mol/kgw
    temp      25.0
    pH        7.0
    Na        1.0
    Cl        1.0 charge
    water     0.02

EXCHANGE 1
    X 0.1
    -equilibrate 1
EXCHANGE 2
    X 0.1
    -equilibrate 2
EXCHANGE 3
    X 0.1
    -equilibrate 3
EXCHANGE 4
    X 0.1
    -equilibrate 4
EXCHANGE 5
    X 0.1
    -equilibrate 5
EXCHANGE 6
    X 0.1
    -equilibrate 6
EXCHANGE 7
    X 0.1
    -equilibrate 7
EXCHANGE 8
    X 0.1
    -equilibrate 8
EXCHANGE 9
    X 0.1
    -equilibrate 9
EXCHANGE 10
    X 0.1
    -equilibrate 10
EXCHANGE 11
    X 0.1
    -equilibrate 11
EXCHANGE 12
    X 0.1
    -equilibrate 12
EXCHANGE 13
    X 0.1
    -equilibrate 13
EXCHANGE 14
    X 0.1
    -equilibrate 14
EXCHANGE 15
    X 0.1
    -equilibrate 15
EXCHANGE 16
    X 0.1
    -equilibrate 16
EXCHANGE 17
    X 0.1
    -equilibrate 17
EXCHANGE 18
    X 0.1
    -equilibrate 18
EXCHANGE 19
    X 0.1
    -equilibrate 19
EXCHANGE 20
    X 0.1
    -equilibrate 20

TRANSPORT
    -cells    20
    -shifts   50
    -lengths  0.05
    -flow_direction forward
    -boundary_conditions flux flux
    -punch_frequency 5

SELECTED_OUTPUT 1
    -file sac_individual.csv
    -reset false
    -step true
    -totals Ca Mg Na X

USER_PUNCH 1
    -headings Step Cell BV Ca_mg/L Total_X
    -start
    10 PUNCH STEP_NO
    20 PUNCH CELL_NO
    30 PUNCH STEP_NO * 0.02 / 1.0
    40 PUNCH TOT("Ca") * 40078
    50 PUNCH TOT("X")
    -end

END
